<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="LatinVocabStyles.css">
	<title></title>
</head>
<body>
<div class="top">
    <h1>Nosce Verba Latinae!</h1>

    <pre>This page is now a vocabulary studying app.
    <a href="/main/">Click here to continue to wadsworth.tech proper.</a>
    </pre>
</div>

<script type="text/javascript">
var ch28 = [
  ["continēns", "continentis: continuous, unbroken"],
  ["nāvēs solvō", "solvere, solvī, solūtum: to set sail"],
  ["portus", "portūs, m: port, haven, harbor"],
  ["propius", "nearer"],
  ["unde", "whence, from where"]
];

var ch27 = [
  ["arcessō", "arcessere, arcessīvī, arcessītum: to summon, send for, invite"],
  ["obses", "obsidis, c: hostage; pledge, security"],
  ["polliceor", "pollicērī, pollicitus sum: to promise, offer"],
  ["queror", "querī, questus sum: to complain, bewail, lament"],
  ["ultrō", "voluntarily; besides, moreover"],
  ["vinculum","vinculī, n: chain"]
];

var ch29 = [
  ["adflīgō","adflīgere, adflīxī, adflīctum: to overthrow, damage, injure"],
  ["aestus","aestūs, m: heat, boiling, surging, tide"],
  ["armāmenta","armāmentōrum, n. pl.: implements, gear, tackle, rigging"],
  ["dēligō","1: to bind, tie down, fasten, moor"],
  ["fūnis","fūnis, m: rope, cable"]
];

var chapters = [
    [ch27, "De Bello Gallico Chapter 27"],
    [ch28, "De Bello Gallico Chapter 28"],
    [ch29, "De Bello Gallico Chapter 29"]
];

var chapterWords = ch27;
</script>

<a href="http://www.cs.waikato.ac.nz/~tetaka/PDF/Macron%20Vowels%20on%20a%20Mac%2010.6-7.pdf"><p> To correctly use this app, you will need to download the Māori keyboard. </p></a>

<script type="text/javascript">
    for (var chaptersIndex = 0; chaptersIndex < chapters.length; chaptersIndex++)
{
    createButton(chapters[chaptersIndex][1]);
}

function createButton(value)
{
    var x = document.createElement("BUTTON");
    var t = document.createTextNode(value);
    x.appendChild(t);
    document.body.appendChild(x);
    x.id = value;
    x.onclick = function(){
        for (var i = 0; i < chapters.length; i++)
        {
            if (x.id == chapters[i][1])
            {
                chapterWords = chapters[i][0];
                document.getElementById("currentChapter").innerText = chapters[i][1];
            }
        }
        runProgram(chapterWords);
    };
}
</script>

<p id="currentChapter">De Bello Gallico Chapter 27</p>

<p id= "term" style= "margin-bottom: 0px;"> Term: </p>
<p id="prompt" style= "margin-top: 0px;"></p>

<div class="inputBox">
    <p style= "margin-bottom: 0px;">Answer:</p>
    <input id="textInput" type="text" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
</div>

<p id="reaction" style="margin-top: 32px;"></p>

<script type="text/javascript">

runProgram(chapterWords);

function runProgram(words)
{
    var i = 0;

    document.getElementById("prompt").innerText = words[i][0];

    var entered = false;

    getInput(i);

    function getInput(i)
    {
    	document.getElementById("prompt").innerText = words[i][0];
    	document.getElementById("textInput").value = "";
    	document.getElementById("textInput").onchange = function(e)
    	{
    		if (!entered)
    		{
    			var response = document.getElementById("textInput").value;
    	        
    	        entered = true;

    	        var definitionWords = getDefinitionWords(i);

    	        var correctDefinition = false;

    	        for (var ind = 0; ind < definitionWords.length; ind++)
    	        {
    	        	if ((response.substring(response.indexOf(":") + 1)).indexOf(definitionWords[ind]) != -1)
    	        	{
    	        		correctDefinition = true;
    	        	}
    	        }
    	        
    	        if (response.substring(0, response.indexOf(":")) == words[i][1].substring(0, words[i][1].indexOf(":")) && correctDefinition)
    			{
    				document.getElementById("reaction").innerText = "Good job! \n You said: " + response;
    				document.getElementById("reaction").style.color = "green";
    			}
    			else
    			{
    				document.getElementById("reaction").innerText = "Incorrect. \n You said: " + words[i][0] + ": " + response + "\nCorrect: " + words[i][0] + ": " + words[i][1];
    				document.getElementById("reaction").style.color = "red";
    			}
    			
    			entered = false;
    			
    			if (i < words.length - 1)
    			{
    				getInput(i + 1);
    			}
    			else
    			{
    				document.getElementById("term").innerText = "";
                    document.getElementById("prompt").innerText = "You are done.";
    				document.getElementById("textInput").value = "";
    				entered = true;
    			}
    		}
    	};
    }

    /**
    *	Parses the English definition of the Latin and inserts each parsed word
    *	of the English into an array.  Returns the array.
    *
    *	parameter i: the index of the current vocab in the 2D array called words
    **/
    function getDefinitionWords(i)
    {
        var correctWords = new Array();	//The array to contain the English words
        
        var correctDef = words[i][1].substring((words[i][1].indexOf(":") + 1));	//The full correct English definition

        //Cuts out words from right to left until the definition has length 0
        while (correctDef.length > 0)
        {
            //Handles the case where a comma comes after the word or where the current word is the last
            if (correctDef.indexOf(",") != -1)
            {
                var currentWord = correctDef.substring(0, correctDef.indexOf(","));	//The current English word
                
                //Removes "to" from before verbs
                if (currentWord.indexOf(" to") != -1)
                {
                    currentWord = currentWord.substring(currentWord.indexOf(" to") + 3);
                }

                //Removes spaces from before words
                while (currentWord.indexOf(" ") == 0)
                {
                    currentWord = currentWord.substring(1);
                }
                correctDef = correctDef.substring(correctDef.indexOf(",") + 1);	//Cuts the current word from the definition
            }
            else
            {
                currentWord = correctDef;	//This is the last word so no splicing is necessary
                correctDef = "";			//Makes definition of length 0
                if (currentWord.indexOf(" to") != -1)
                {
                    currentWord = currentWord.substring(currentWord.indexOf(" to") + 3);
                    console.log(currentWord);
                }

                while (currentWord.indexOf(" ") == 0)
                {
                    currentWord = currentWord.substring(1);
                }
            } 
                correctWords.push(currentWord);
        }
        return correctWords;
    }
}
</script>
</body>
</html>